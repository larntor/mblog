---
title: "UWP 和 WPF 对比"
author: lindexi
date: 2018-4-17 8:57:53 +0800
CreateTime: 2018-4-16 20:28:43 +0800
categories: WPF UWP dotnetcore
---

本文告诉大家 UWP 和 WPF 的不同。
如果在遇到技术选择或者想和小伙伴吹的时候可以让他以为自己很厉害，那么请继续看。

<!--more-->


<!-- csdn -->

<!-- 标签：wpf,uwp,dotnetcore -->

如果在看这文章还不知道什么是 UWP 和 WPF 那么也没关系，下面会告诉大家。

实际上 Universal Windows Platform (UWP) 和 Windows Presentation Foundation (WPF) 是不相同的，虽然都可以做界面和桌面开发，但是 UWP 是一个新的 UI 框架，而且 UWP 是支持很多平台，至少比 WPF 多。


那么 UWP 可以使用什么写？

- xaml 做的 UI 和 C#、VB 写的后台

- xaml 的 UI 和 C++ Native 写的后台

- DirectX 的 UI 和 C++ Native 写的后台

- JavaScript 和 HTML

WPF 呢？他可以使用 xaml 做的前台，C#、VB、F#、C++写的后台。

不过需要知道，WPF 的C++ 后台使用的是托管的C++。

那么网上怎么好多小伙伴说 UWP 的性能比 WPF 好？

因为 UWP 的渲染使用的是 [DirectComposition](https://msdn.microsoft.com/zh-cn/library/windows/desktop/hh437376.aspx ) 而 WPF 使用的 [Desktop Window Manager](https://msdn.microsoft.com/en-us/library/windows/desktop/aa969540(v=vs.85).aspx )，请不要在这里和我说 WPF 使用的 DX9 。

虽然 WPF 渲染是通过 Dx9 但是最后显示出来是需要 DWM ，所以上面这样说。

之外，UWP 使用 dot net core 编译出来的是 Native 本地代码，WPF 使用 dot net Framework 编译出来是 IL 代码，需要知道 编译出来 Native 代码的性能是 80% C++非托管。所以代码运行会快很多。

这时不要说 IL 可以针对每个 CPU 做优化，因为 dot net core 编译的代码就是对不同的 CPU 做优化。如果还需要对特殊CPU做优化，我还没找到。

## 发布时间

WPF 在 2006 年发布，那时使用的 .net Framework 3.0 ，现在已经是 WPF 4 了。

UWP 在 2015 年发布，那时还没有 dot net core 1.0

所以垃圾微软的 UWP 有兼容问题，如果选择最低平台，千万不要 10240 这个版本的 api 很多都后来系统没有提供。

## 系统要求

因为 WPF 发布的时候还没有 Win7 所以 WPF 是支持 xp 的，但是需要 .net Framework 4.0 ，如果比 4.0 大就无法支持。

需要知道，在 4.5之后 WPF 才修复很多 bug ，提升性能，能不支持 xp 就不要支持 xp。

UWP 发布的时候，因为使用的是 WinRT ，而 WPF 使用的是 COM ，所以UWP不支持以前系统，最低是 win10.

## 平台

虽然 WPF 很厉害，但是发布的时候几乎没有人知道多平台，所以 WPF 只能支持桌面和 windows 平板。但是现在有 [Avalonia](https://github.com/avaloniaUI/Avalonia) 和 [Xamarin WPF](https://docs.microsoft.com/en-us/xamarin/xamarin-forms/platform/wpf )

全平台 UWP 支持PC， Notebook， Tablet， Phone， Xbox， IoT， Surface Hub，需要说的最后一个大家不用支持，因为说了10年还没有卖。

## 输入

虽然微软说 WPF 是支持触摸的，但是在 4.7 之前的触摸是很差的。所以 WPF 支持鼠标键盘。

但是 UWP 是支持触摸的，鼠标、键盘。

## 界面

虽然 WPF 和 UWP 都使用 xaml 做界面，但是渲染是不相同的。 WPF 的渲染都是使用托管代码计算，然后通过通道使用 DirectX 9 渲染。渲染完成给 DWM 选择是否显示。但是 WPF 没有使用 DirectX 9 的性能，所以渲染是比较慢的。

我尝试使用 WriteableBitmap 渲染，结果性能比 WPF 渲染快。

但是 UWP 的渲染很快，因为他使用[DirectComposition](https://msdn.microsoft.com/zh-cn/library/windows/desktop/hh437376.aspx )直接渲染，使用 DX11 渲染。不使用 DWM 选择。而且渲染的代码都是编译本地，比较多使用 DX11 ，但是对于很多硬件都支持 dx12 。

## 定制

虽然开始的 WPF 定制不好，但是现在的 WPF 定制是很好的，可以使用 Host 加入其他的程序，可以使用 dx 加入。

但是 UWP 的定制虽然像 UWP 但是限制很多，一个就是他的源代码看不到，其他的就是很多功能无法使用，如 Adorner 和继承属性。

## 样式

虽然看起来 WPF 和 UWP 的样式定义是一样的，但是 UWP 没有了功能很好的 Trigger 和样式继承。这样 UWP 的功能就没有 WPF 那么容易定制。

## 调试

在 WPF 如果有一个代码抛异常，那么 VisualStudio 很容易告诉大家是哪里异常，因为 VisualStudio 也是 WPF 写的。但是如果 dot net core 抛异常，那么 VisualStudio 很难告诉但是哪里异常，不过 UWP 是 dot net core 写的，所以 UWP 的异常很难知道是哪里异常，特别是界面异常，经常告诉大家出现一个未知的异常。

## 安装

现在的 WPF 可以做绿色版，直接运行就可以。不过要求用户的电脑有 .net Framework 。

但是 dot net core可以带所有的环境，所以 UWP 安装不需要要求用户有 .net Framework 环境，不过 UWP 只能通过应用商店和开发者方式安装。

很多小伙伴还不会安装 UWP 程序，虽然双击就可以安装。

虽然 UWP 不需要 .net framework 环境，但是他需要 win10 ，现在很多用户的电脑都是 win7 所以暂时很难直接告诉大家使用 UWP ，很多人无法安装。

## 文件

在 WPF 几乎所有文件都能使用，如果发现有文件没权限，那么可以通过申请的方式拿到。对比 WPF 这么不安全，因为可能有开发者删掉了重要的文件，微软提出了安全的代码，所有的不是应用内的文件都需要用户申请才可以。

## 成熟

WPF 是比较成熟的，现在已经有 10 多年，有很多库，而且遇到的问题基本都有人遇到。

对于 UWP ，是比较不成熟，很多功能没有。



参见：[UWP vs. WPF · jbe2277/waf Wiki](https://github.com/jbe2277/waf/wiki/UWP-vs.-WPF )

![](https://i.loli.net/2018/04/08/5ac9fff835cfe.jpg)

